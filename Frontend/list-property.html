<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>List Your Property â€” BookingHours</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="assets/styles.css">
  <style>
    .form-section {
      background: #fff;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .form-section h5 {
      color: #0d47a1;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 2px solid #eef2ff;
    }
    .room-item, .package-item {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      position: relative;
    }
    .remove-btn {
      position: absolute;
      top: 10px;
      right: 10px;
    }
    .file-upload-area {
      border: 2px dashed #cbd5e1;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      background: #f8fafc;
      cursor: pointer;
      transition: all 0.3s;
    }
    .file-upload-area:hover {
      border-color: #0d6efd;
      background: #eef2ff;
    }
    .file-upload-area.dragover {
      border-color: #0d6efd;
      background: #e6f0ff;
    }
  </style>
</head>
<body>
  <nav id="mainNav" class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="index.html">
        <span class="logo-brand">BookingHours.com</span>
      </a>
      <div id="navAuthPlaceholder"></div>
    </div>
  </nav>

  <main class="container my-5">
    <div class="row">
      <div class="col-lg-10 mx-auto">
        <div class="text-center mb-4">
          <h1 class="display-5 fw-bold">List Your Property</h1>
          <p class="lead text-muted">Join BookingHours and reach thousands of travelers looking for hourly stays</p>
          <div id="welcomeMessage" class="alert alert-success d-none" role="alert">
            <strong>Welcome!</strong> Your account has been created successfully. Please fill out the form below to list your property.
          </div>
        </div>

        <form id="propertyForm" enctype="multipart/form-data">
          <div class="form-section">
            <h5 class="mb-4">Fill this form to List your Property on BookingHours</h5>
            
            <!-- Main Form Fields in 3-Column Layout (matching Bag2Bag) -->
            <div class="row g-3">
              <!-- Column 1 -->
              <div class="col-md-4">
                <label class="form-label">Property Name <span class="text-danger">*</span></label>
                <input type="text" name="propertyName" class="form-control" placeholder="Property Name" required>
                
                <label class="form-label mt-3">Owner Mobile Number <span class="text-danger">*</span></label>
                <input type="tel" name="ownerMobile" class="form-control" placeholder="Owner Mobile Number" required>
                
                <label class="form-label mt-3">Owner Email Id <span class="text-danger">*</span></label>
                <input type="email" name="ownerEmail" class="form-control" placeholder="Owner Email Id" required>
                
                <label class="form-label mt-3">State <span class="text-danger">*</span></label>
                <input type="text" name="state" class="form-control" placeholder="State" required>
                
                <label class="form-label mt-3">Landmark</label>
                <input type="text" name="landmark" class="form-control" placeholder="Landmark">
                
                <label class="form-label mt-3">GST No</label>
                <input type="text" name="gstNo" class="form-control" placeholder="GST No">
                
                <label class="form-label mt-3">Upload GST Certificate</label>
                <input type="file" name="gstCertificate" class="form-control" accept=".pdf,.jpeg,.jpg,.png,.webp">
                <small class="text-muted d-block mt-1">Upto 1 File, Max 5MB each (PDF, JPEG, PNG, WEBP)</small>
              </div>

              <!-- Column 2 -->
              <div class="col-md-4">
                <label class="form-label">Property Type <span class="text-danger">*</span></label>
                <select name="propertyType" class="form-select" required>
                  <option value="">Property Type</option>
                  <option value="Apartment">Apartment</option>
                  <option value="Condominium">Condominium</option>
                  <option value="Farm Stay">Farm Stay</option>
                  <option value="Guest House">Guest House</option>
                  <option value="Homestay">Homestay</option>
                  <option value="Hostel">Hostel</option>
                  <option value="Hotel">Hotel</option>
                  <option value="Houseboat">Houseboat</option>
                  <option value="Lodge">Lodge</option>
                  <option value="Motel">Motel</option>
                  <option value="Resort">Resort</option>
                  <option value="Room">Room</option>
                  <option value="Vacation Rental">Vacation Rental</option>
                  <option value="Villa">Villa</option>
                </select>
                
                <label class="form-label mt-3">Reception Landline Number</label>
                <input type="tel" name="receptionLandline" class="form-control" placeholder="Reception Landline Number">
                
                <label class="form-label mt-3">City <span class="text-danger">*</span></label>
                <input type="text" name="city" class="form-control" placeholder="City" required>
                
                <label class="form-label mt-3">Address <span class="text-danger">*</span></label>
                <textarea name="address" class="form-control" rows="3" placeholder="Address" required></textarea>
                
                <label class="form-label mt-3">Google Business Page Link</label>
                <input type="url" name="googleBusinessLink" class="form-control" placeholder="Google Business Page Link">
                
                <label class="form-label mt-3">PAN No</label>
                <input type="text" name="panNo" class="form-control" placeholder="PAN No">
                
                <label class="form-label mt-3">Upload PAN Card</label>
                <input type="file" name="panCard" class="form-control" accept=".pdf,.jpeg,.jpg,.png,.webp">
                <small class="text-muted d-block mt-1">Upto 1 File, Max 5MB each (PDF, JPEG, PNG, WEBP)</small>
              </div>

              <!-- Column 3 -->
              <div class="col-md-4">
                <label class="form-label">Reception Mobile Number <span class="text-danger">*</span></label>
                <input type="tel" name="receptionMobile" class="form-control" placeholder="Reception Mobile Number" required>
                
                <label class="form-label mt-3">Reception Email Id <span class="text-danger">*</span></label>
                <input type="email" name="receptionEmail" class="form-control" placeholder="Reception Email Id" required>
                
                <label class="form-label mt-3">Locality</label>
                <input type="text" name="locality" class="form-control" placeholder="Locality">
                
                <label class="form-label mt-3">Pincode</label>
                <input type="text" name="pincode" class="form-control" placeholder="Pincode">
                
                <label class="form-label mt-3">Upload Property Images</label>
                <div class="file-upload-area" onclick="document.getElementById('propertyImages').click()">
                  <input type="file" id="propertyImages" name="propertyImages" multiple accept=".jpeg,.jpg,.png,.webp" style="display:none;">
                  <div style="font-size: 2rem; color: #0d6efd;">ðŸ“¤</div>
                  <p class="mt-2 mb-0">Click to upload</p>
                  <small class="text-muted">Upto 20 File, Max 5MB each (JPEG, PNG, WEBP)</small>
                </div>
                <div id="imagePreview" class="mt-3 d-flex flex-wrap gap-2"></div>
              </div>
            </div>
          </div>

          <!-- Overnight Room Details -->
          <div class="form-section">
            <h5>Day Room Details</h5>
            <div id="overnightRooms"></div>
            <button type="button" class="btn btn-outline-primary" onclick="addOvernightRoom()">
              + Add Room
            </button>
          </div>

          <!-- Hourly Stay Room Details -->
          <div class="form-section">
            <h5>Hourly Stay Room Details</h5>
            <div id="hourlyRooms"></div>
            <button type="button" class="btn btn-outline-primary" onclick="addHourlyRoom()">
              + Add Room
            </button>
          </div>

          <!-- Packages -->
          <div class="form-section">
            <h5>Packages</h5>
            <div id="packages"></div>
            <button type="button" class="btn btn-outline-primary" onclick="addPackage()">
              + Add package
            </button>
          </div>

          <!-- Submit Button -->
          <div class="text-center my-4">
            <button type="submit" class="btn btn-primary btn-lg px-5">
              Submit Application
            </button>
          </div>
        </form>
      </div>
    </div>
  </main>

  <footer class="py-4 bg-white mt-5">
    <div class="container text-center small text-muted">Â© BookingHours.com</div>
  </footer>

  <script src="assets/app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Check if user just signed up (from URL parameter or session)
    const urlParams = new URLSearchParams(window.location.search);
    const fromSignup = urlParams.get('from') === 'signup' || sessionStorage.getItem('justSignedUp') === 'true';
    
    if (fromSignup) {
      // Show welcome message
      document.getElementById('welcomeMessage').classList.remove('d-none');
      // Clear the flag
      sessionStorage.removeItem('justSignedUp');
      
      // Try to pre-fill email if available from signup
      try {
        const signupData = JSON.parse(sessionStorage.getItem('signupData') || '{}');
        if (signupData.email) {
          document.querySelector('input[name="ownerEmail"]').value = signupData.email;
          document.querySelector('input[name="receptionEmail"]').value = signupData.email;
        }
        if (signupData.phone) {
          document.querySelector('input[name="ownerMobile"]').value = signupData.phone;
          document.querySelector('input[name="receptionMobile"]').value = signupData.phone;
        }
        if (signupData.name) {
          // Could pre-fill property name with owner name
        }
        // Clear signup data after using it
        sessionStorage.removeItem('signupData');
      } catch (e) {
        console.log('No signup data to pre-fill');
      }
    }

    let overnightRoomCount = 0;
    let hourlyRoomCount = 0;
    let packageCount = 0;

    // Add Overnight Room
    function addOvernightRoom() {
      const container = document.getElementById('overnightRooms');
      const roomId = 'overnight_' + overnightRoomCount++;
      const roomHtml = `
        <div class="room-item" id="${roomId}">
          <button type="button" class="btn btn-sm btn-danger remove-btn" onclick="removeRoom('${roomId}')">Ã—</button>
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Room Category</label>
              <input type="text" name="overnightRooms[${roomId}][category]" class="form-control" placeholder="e.g., Deluxe, Suite">
            </div>
            <div class="col-md-6">
              <label class="form-label">Rate Plan</label>
              <select name="overnightRooms[${roomId}][ratePlan]" class="form-select">
                <option value="EP">EP</option>
                <option value="CP">CP</option>
                <option value="MAP">MAP</option>
                <option value="AP">AP</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label">Rate for 1 Night (Exclusive of GST)</label>
              <input type="number" name="overnightRooms[${roomId}][rate]" class="form-control" placeholder="Rate Per Night">
            </div>
            <div class="col-md-6">
              <label class="form-label">Addition Guest Rate (Exclusive of GST)</label>
              <input type="number" name="overnightRooms[${roomId}][additionalGuestRate]" class="form-control" placeholder="Additional Guest Rate">
            </div>
            <div class="col-md-6">
              <label class="form-label">Number of Free Children Allowed</label>
              <input type="number" name="overnightRooms[${roomId}][freeChildren]" class="form-control" min="0">
            </div>
            <div class="col-md-6">
              <label class="form-label">Addition Child Rate (Exclusive of GST)</label>
              <input type="number" name="overnightRooms[${roomId}][additionalChildRate]" class="form-control" placeholder="Addition Child Rate">
            </div>
            <div class="col-md-6">
              <label class="form-label">Standard Room Occupancy</label>
              <input type="number" name="overnightRooms[${roomId}][standardOccupancy]" class="form-control" min="1">
            </div>
            <div class="col-md-6">
              <label class="form-label">Max Room Occupancy (Adults + Children)</label>
              <input type="number" name="overnightRooms[${roomId}][maxOccupancy]" class="form-control" min="1">
            </div>
          </div>
        </div>
      `;
      container.insertAdjacentHTML('beforeend', roomHtml);
    }

    // Add Hourly Room
    function addHourlyRoom() {
      const container = document.getElementById('hourlyRooms');
      const roomId = 'hourly_' + hourlyRoomCount++;
      const roomHtml = `
        <div class="room-item" id="${roomId}">
          <button type="button" class="btn btn-sm btn-danger remove-btn" onclick="removeRoom('${roomId}')">Ã—</button>
          <div class="row g-3">
            <div class="col-md-12">
              <label class="form-label">Room Category</label>
              <input type="text" name="hourlyRooms[${roomId}][category]" class="form-control" placeholder="e.g., Deluxe, Suite">
            </div>
            <div class="col-md-6">
              <label class="form-label">Rate for 3 Hour Slot (Exclusive of GST)</label>
              <input type="number" name="hourlyRooms[${roomId}][rate3h]" class="form-control" placeholder="Rate for 3 Hour Slot">
            </div>
            <div class="col-md-6">
              <label class="form-label">Rate for 6 Hour Slot (Exclusive of GST)</label>
              <input type="number" name="hourlyRooms[${roomId}][rate6h]" class="form-control" placeholder="Rate for 6 Hour Slot">
            </div>
            <div class="col-md-6">
              <label class="form-label">Rate for 9 Hour Slot (Exclusive of GST)</label>
              <input type="number" name="hourlyRooms[${roomId}][rate9h]" class="form-control" placeholder="Rate for 9 Hour Slot">
            </div>
            <div class="col-md-6">
              <label class="form-label">Rate for 12 Hour Slot (Exclusive of GST)</label>
              <input type="number" name="hourlyRooms[${roomId}][rate12h]" class="form-control" placeholder="Rate for 12 Hour Slot">
            </div>
            <div class="col-md-6">
              <label class="form-label">Rate for 24 Hour Slot (Exclusive of GST)</label>
              <input type="number" name="hourlyRooms[${roomId}][rate24h]" class="form-control" placeholder="Rate for 24 Hour Slot">
            </div>
            <div class="col-md-6">
              <label class="form-label">Addition Guest Rate (Exclusive of GST)</label>
              <input type="number" name="hourlyRooms[${roomId}][additionalGuestRate]" class="form-control" placeholder="Additional Guest Rate">
            </div>
            <div class="col-md-6">
              <label class="form-label">Number of Free Children Allowed</label>
              <input type="number" name="hourlyRooms[${roomId}][freeChildren]" class="form-control" min="0" placeholder="Number of Free Children Allowed">
            </div>
            <div class="col-md-6">
              <label class="form-label">Addition Child Rate (Exclusive of GST)</label>
              <input type="number" name="hourlyRooms[${roomId}][additionalChildRate]" class="form-control" placeholder="Addition Child Rate">
            </div>
            <div class="col-md-6">
              <label class="form-label">Standard Room Occupancy</label>
              <input type="number" name="hourlyRooms[${roomId}][standardOccupancy]" class="form-control" min="1">
            </div>
            <div class="col-md-6">
              <label class="form-label">Max Room Occupancy (Adults + Children)</label>
              <input type="number" name="hourlyRooms[${roomId}][maxOccupancy]" class="form-control" min="1">
            </div>
          </div>
        </div>
      `;
      container.insertAdjacentHTML('beforeend', roomHtml);
    }

    // Add Package
    function addPackage() {
      const container = document.getElementById('packages');
      const packageId = 'package_' + packageCount++;
      const packageHtml = `
        <div class="package-item" id="${packageId}">
          <button type="button" class="btn btn-sm btn-danger remove-btn" onclick="removeRoom('${packageId}')">Ã—</button>
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Room Category</label>
              <input type="text" name="packages[${packageId}][category]" class="form-control">
            </div>
            <div class="col-md-6">
              <label class="form-label">Number of Night</label>
              <input type="number" name="packages[${packageId}][nights]" class="form-control" min="1">
            </div>
            <div class="col-md-6">
              <label class="form-label">Number of Day</label>
              <input type="number" name="packages[${packageId}][days]" class="form-control" min="1">
            </div>
            <div class="col-md-6">
              <label class="form-label">Number of Child</label>
              <input type="number" name="packages[${packageId}][children]" class="form-control" min="0">
            </div>
            <div class="col-md-6">
              <label class="form-label">Rate of Package</label>
              <input type="number" name="packages[${packageId}][rate]" class="form-control" placeholder="Rate of Package">
            </div>
            <div class="col-md-6">
              <label class="form-label">Additional Adult Rate</label>
              <input type="number" name="packages[${packageId}][additionalAdultRate]" class="form-control" placeholder="Additional Adult Rate">
            </div>
            <div class="col-md-6">
              <label class="form-label">Additional Child Rate</label>
              <input type="number" name="packages[${packageId}][additionalChildRate]" class="form-control" placeholder="Additional Child Rate">
            </div>
            <div class="col-12">
              <div class="row">
                <div class="col-md-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="packages[${packageId}][roomDecorate]" id="decorate_${packageId}">
                    <label class="form-check-label" for="decorate_${packageId}">Is Room decorate</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="packages[${packageId}][welcomeDrink]" id="drink_${packageId}">
                    <label class="form-check-label" for="drink_${packageId}">Is Welcome Drink</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="packages[${packageId}][candleDinner]" id="dinner_${packageId}">
                    <label class="form-check-label" for="dinner_${packageId}">Is Candle Night Dinner</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="packages[${packageId}][breakfast]" id="breakfast_${packageId}">
                    <label class="form-check-label" for="breakfast_${packageId}">Is Breakfast</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="packages[${packageId}][buffet]" id="buffet_${packageId}">
                    <label class="form-check-label" for="buffet_${packageId}">Is Buffet</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="packages[${packageId}][alacarte]" id="alacarte_${packageId}">
                    <label class="form-check-label" for="alacarte_${packageId}">Is Alacarte</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="packages[${packageId}][spa]" id="spa_${packageId}">
                    <label class="form-check-label" for="spa_${packageId}">Is Spa</label>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-12">
              <label class="form-label">Inclusions (If any Activities, Entertainment,etc)</label>
              <textarea name="packages[${packageId}][inclusions]" class="form-control" rows="2" placeholder="Enter your inclusion here"></textarea>
            </div>
          </div>
        </div>
      `;
      container.insertAdjacentHTML('beforeend', packageHtml);
    }

    // Remove Room/Package
    function removeRoom(id) {
      document.getElementById(id).remove();
    }

    // Image Preview
    document.getElementById('propertyImages').addEventListener('change', function(e) {
      const preview = document.getElementById('imagePreview');
      preview.innerHTML = '';
      Array.from(e.target.files).forEach(file => {
        const reader = new FileReader();
        reader.onload = function(e) {
          const img = document.createElement('img');
          img.src = e.target.result;
          img.style.width = '150px';
          img.style.height = '150px';
          img.style.objectFit = 'cover';
          img.style.borderRadius = '8px';
          img.className = 'mb-2';
          preview.appendChild(img);
        };
        reader.readAsDataURL(file);
      });
    });

    // Form Submission
    document.getElementById('propertyForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const formData = new FormData(this);
      
      try {
        const response = await fetch(API_BASE + '/property/list', {
          method: 'POST',
          body: formData
        });

        const result = await response.json();
        
        if (response.ok) {
          alert('Property listing submitted successfully! We will contact you within 24 hours.');
          this.reset();
          document.getElementById('overnightRooms').innerHTML = '';
          document.getElementById('hourlyRooms').innerHTML = '';
          document.getElementById('packages').innerHTML = '';
          document.getElementById('imagePreview').innerHTML = '';
          overnightRoomCount = 0;
          hourlyRoomCount = 0;
          packageCount = 0;
        } else {
          alert('Error: ' + (result.error || 'Failed to submit application'));
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Network error. Please try again.');
      }
    });
  </script>
</body>
</html>

